define("Profile",["require","exports"],function(e,t){"use strict";t.__esModule=!0;var n=function(){function t(e,t,n){this.nickname=e,this.fullName=t,this.email=n,this.subnick=""}return t.prototype.getNickname=function(){return this.nickname},t.prototype.getFullName=function(){return this.fullName},t.prototype.getEmail=function(){return this.email},t.prototype.getSubnick=function(){return this.subnick},t.prototype.display=function(e){e.innerHTML=this.nickname},t.prototype.registerUser=function(){var t=e("mysql").createConnection({host:"localhost",user:"tunnel",password:"123456",database:"TunnelMessenger"});t.connect();var n="INSERT INTO users(username, nickname, subnick, fullName, email)                     VALUES("+this.nickname+","+this.nickname+","+this.subnick+",                     "+this.email+")";t.query(n,function(e){if(e)throw e;console.log(n)}),t.end},t}();t.User=n}),define("Message",["require","exports"],function(e,t){"use strict";t.__esModule=!0;var n=function(){function e(e,t,n){this.content=e,this.author=t,this.datetime=n}return e.prototype.display=function(e){e.innerHTML=this.content},e.prototype.getAuthor=function(){return this.author},e.prototype.getDatetime=function(){return this.datetime},e.prototype.getContent=function(){return this.content},e}();t.TextMessage=n}),define("Utils",["require","exports"],function(e,t){"use strict";t.__esModule=!0;!function(e){e.create=function(e,t){var n=document.createElement(e);return t&&this.foreach(t,function(e,t){"click"==e?n.addEventListener("click",t):n[e]=t}),n},e.foreach=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&!1===t(n,e[n]))break}}(t.utils||(t.utils={}))}),define("Chat",["require","exports","Utils"],function(e,t,n){"use strict";t.__esModule=!0;var s=function(){function e(e,t,n){this.messages=[],this.name=e,this.users=t,this.node=n}return e.prototype.addMessage=function(e){var t=this.messages[this.messages.length-1];this.messages.push(e),console.log("previous:",t),console.log("this:",e),t&&e.getAuthor()==t.getAuthor()||(console.log("[SPAWN]"),this.spawnMessageBlock()),console.log("[MERGE]"),this.mergeWithLastBlock(e)},e.prototype.spawnMessageBlock=function(){var e=this.messages[this.messages.length-1],t=n.utils.create("div",{className:"messageBlock"}),s=n.utils.create("div",{className:"author"});e.getAuthor().display(s),t.appendChild(s),this.node.appendChild(t),this.lastMessageBlock=t},e.prototype.mergeWithLastBlock=function(e){var t=n.utils.create("div",{className:"content"});e.display(t),this.lastMessageBlock.appendChild(t)},e}();t.Chat=s}),define("main",["require","exports","Chat","Message","Profile"],function(e,t,n,s,i){"use strict";t.__esModule=!0,$(document).ready(function(){console.log("Server running.");var e=io(),t=new n.Chat("Chat #1",[],$("#display").get(0));$("#sendMessage").click(function(){return e.emit("chat message",$("#messageBox").val()),$("#messageBox").val(""),!1}),$("#nicknameButton").click(function(){return e.emit("changeNick",$("#nicknameBox").val()),$("#nicknameBox").val(""),!1}),$("#messageBox").keyup(function(t){13==t.keyCode?$("#sendMessage").click():(e.emit("isTyping"),setTimeout(function(){e.emit("stoppedTyping")},1e3))});var o={};e.on("chat message",function(e,n){o.hasOwnProperty(e)||(o[e]=new i.User(e,e+" da Silva",e+"@baidu.com"));var a=new s.TextMessage(n,o[e],new Date);t.addMessage(a),$("html, body").scrollTop($(document).height())}),e.on("isTyping",function(e){$("#typingCell").html(e+" is typing...")}),e.on("stoppedTyping",function(){$("#typingCell").html("")})})});
